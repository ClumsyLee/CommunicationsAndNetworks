% 第一次编程作业
% 无36
  李思涵
  2013011187
  <lisihan969@gmail.com>
% \today

# 题目

某信道，输入为 $M$ 元逻辑符号 $x: s_0, s_1, \cdots, s_{M-1}$，输出 $y$ 为实数值。
信道中发生如下事件：

- $a = f(x)$ 到实数的一一映射，当 $x = s_i$ 时，$a = iA$，$A$ 为一给定的正实数
- $y = a + n$，$n$ 为一服从 $N(0, \sigma^2)$ 分布的独立随机变量（与 $x$ 独立，且每次信道实现时的 $n$ 均独立）

1. 写出信道转移概率 $p(y\mid x = s_i)$
2. 若输入信道的各符号等概出现，求该信道的互信息量
3. 画出不同信噪比下的互信息量变化的曲线，以 $M$ 为参数，画一簇曲线（其中加上一条 AWGN 信道容量曲线作对比）
4. 调整函数 $a = f(x)$，使当 $x = s_i$ 时，$a = iA ‐ b$ ，$b$ 也为一实常数，在 $A$ 和 $\sigma$ 不变的情况下，互信息量随 $b$ 的变化情况是什么趋势？
5. $b$ 的取值对互信息量随信噪比的变化曲线的影响？

# 理论推导

## 信道转移概率

记噪声 $n$ 的概率密度函数为 $f(n)$，则易知

\[
  f(n) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{n^2}{2\sigma^2}}
\]

当 $x = s_i$ 时，$a = iA$，故 $y = a + n$ 的条件概率密度函数为

\[
  p(y\mid x = s_i) = \frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(y-iA)^2}{2\sigma^2}}
\]

## 信道的互信息量

对于 $f(n)$，其熵为

\[
  H(N) = \log{2}{\sigma\sqrt{2\pi e}}\ (\text{bit})
\]

而 $y$ 的概率密度函数为

\[
  p(y) = \sum_{i=0}^{M-1}{P(X = s_i)p(y\mid x = s_i)}
       = \frac{1}{M}\sum_{i=0}^{M-1}\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(y-iA)^2}{2\sigma^2}}
\]


故平均互信息量为

\[
  I(X, Y) = H(Y) - H(N) = -\int_{-\infty}^{\infty}{p(y)\log_2{p(y)}dy} - 
                          \log_2{\sigma\sqrt{2\pi e}}\ (\text{bit})
\]

## 互信息量与信噪比的关系

噪声功率 $N$ 满足

\[
  N = \sigma^2
\]

信号功率 $S$ 则满足

\[
  S = \sum_{i=0}^{M-1}{p(x = s_i)(iA)^2} = \frac{A^2}{M}\sum_{i=0}^{M-1}{i^2}
    = \frac{A^2(M-1)(2M-1)}{6}
\]

由于 $A$ 为给定正实数，不妨假设 $A = 1$，即可得到 $\sigma$ 与信噪比的关系

\[
  \sigma = \sqrt{\frac{(M-1)(2M-1)}{6\frac{S}{N}}}
\]

将 $\sigma$ 带入互信息量的表达式，即可以得到互信息量与信噪比的关系。

# 数值模拟

我们在 Mathematica 中进行数值模拟，代码如下：

```mathematica
g[snr_, m_] := 
  Hold@Module[{\[Sigma] = Sqrt[((m - 1) (2 m - 1))/(6 snr)], p},
    p = 1/
      m Sum[1/(\[Sigma] Sqrt[2 \[Pi]])
         E^(-((y - i)^2/(2 \[Sigma]^2))), {i, 0, m - 1}];
    -NIntegrate[ p Log2[p], {y, -Infinity, Infinity}] - 
     Log2[\[Sigma] Sqrt[2 \[Pi] E]]
    ];
Plot[
 Evaluate@With[{snr = 10^(snrdb/10)},
   Append[Table[g[snr, m], {m, 2, 10, 2}],
    1/2 Log2[1 + snr]
    ]],
 {snrdb, 0, 30}, PlotPoints -> 10,
 PlotLegends -> 
  Append[Table["M=" <> ToString[m], {m, 2, 10, 2}], "AWGN"],
 AxesLabel -> {"SNR(dB)", "I(X,Y)"}
 ]
```

得到结果如下：

![互信息量与信噪比的关系](snr-I.png)

# 实验结论
